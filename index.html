<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Harvest Dash" />
  <meta name="base:app_id" content="69906cc5e0d5d2cf831b5bc6" />
  <title>Harvest Dash - Mini Game</title>
  <link rel="stylesheet" href="./style.css" />
  <link rel="stylesheet" href="./responsive.css" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" type="image/svg+xml" href="./hay-bale.svg" />
  <meta name="theme-color" content="#4CAF50" />
</head>

<body>
  <div id="splash-screen"
    style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #87CEEB; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s;">
    <div class="hay-bale-logo"
      style="width: 150px; height: 150px; background: #FFD700; border-radius: 50%; border: 8px solid #DAA520; box-shadow: 0 10px 0 #B8860B; display: flex; align-items: center; justify-content: center; font-size: 80px; margin-bottom: 20px;">
      ðŸšœ</div>
    <h1 style="color: white; text-shadow: 2px 2px 0 #000; font-family: 'Arial Black', sans-serif;">HARVEST DASH</h1>
    <div class="loading-bar-container"
      style="width: 200px; height: 10px; background: rgba(0,0,0,0.2); border-radius: 5px; overflow: hidden; margin-top: 20px;">
      <div id="loading-bar-fill" style="width: 0%; height: 100%; background: #4CAF50; transition: width 0.1s;"></div>
    </div>
    <p style="color: white; margin-top: 10px; font-weight: bold;">LOADING ASSETS...</p>
  </div>
  <div id="weather-overlay"
    style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 50; transition: background 1s; opacity: 0.4;">
  </div>
  <div id="ui-container">
    <div id="start-screen" class="screen active">
      <h1 class="main-title">HARVEST DASH</h1>
      <p>Harvest the coins, avoid the obstacles!</p>
      <button id="music-toggle-start" class="music-toggle">ðŸ”Š</button>

      <div class="menu-buttons">
        <button id="start-btn">START GAME</button>
        <button id="shop-btn-start">SHOP</button>
        <button id="quests-btn-start" style="background: #FF9800; border-color: #E65100;">QUESTS</button>
        <button id="guide-btn-start" class="guide-btn"
          style="background: #4A148C; border-color: #9C27B0;">GUIDE</button>
      </div>

      <div class="start-gold-display">
        GOLD: <span class="coin-icon"></span><span id="start-total-gold">0</span>
        <span style="margin-left: 15px;">JADES: </span><span class="jade-icon"></span><span
          id="start-total-jades">0</span>
        <span style="margin-left: 15px;">BEST: </span><span id="start-high-score">0</span>m
      </div>
      <div style="margin-top: 10px; color: #ddd; font-size: 1.2rem;">LIFETIME: <span id="start-total-dist">0</span>m
      </div>

      <p style="font-size: 1rem; margin-top: 20px; opacity: 0.8;">
        ARROW KEYS / A-D to Move | SPACE / W to Jump
      </p>
    </div>
    <div id="game-over-screen" class="screen">
      <h1>Harvest Dash</h1>
      <p>Distance: <span id="run-distance-over">0</span>m</p>
      <p style="font-size: 1.2rem; color: #FFD700;">BEST: <span id="high-score-over">0</span>m</p>
      <p>Coins: <span class="coin-icon"></span><span id="run-gold-over">0</span></p>
      <p>Wallet: <span class="coin-icon"></span><span id="wallet-over">0</span></p>

      <div id="revive-container" style="margin-bottom: 20px;">
        <div id="revive-timer-text" style="font-size: 1.5rem; color: #ff0000; margin-bottom: 10px;">Revive in: <span
            id="revive-countdown">10</span>s</div>
        <button id="revive-btn" style="background: #4CAF50; border-color: #2E7D32; color: white;">REVIVE (100
          G)</button>
      </div>

      <button id="restart-btn">Try Again</button>
      <button id="shop-btn-over" class="shop-btn">Shop</button>
      <button id="menu-btn-over" style="margin-top: 10px;">Main Menu</button>
    </div>

    <div id="quests-screen" class="screen">
      <h1 style="color: #FF9800;">DAILY QUESTS</h1>
      <div id="quests-list" style="margin-bottom: 20px; width: clamp(250px, 80vw, 400px);">
        <!-- Quests will be injected here -->
      </div>
      <button id="close-quests-btn">CLOSE</button>
    </div>
    <div id="shop-screen" class="screen">
      <p class="balance">
        WALLET: <span class="coin-icon"></span><span id="shop-gold">0</span>
        &nbsp;|&nbsp;
        JADES: <span class="jade-icon"></span><span id="shop-jades">0</span>
      </p>

      <div class="shop-tabs">
        <button id="tab-store" class="tab-btn active">GENERAL STORE</button>
        <button id="tab-skins" class="tab-btn">SKINS</button>
        <button id="tab-mint" class="tab-btn">MINTING STATION</button>
      </div>

      <div id="skins-content" class="tab-content">
        <p style="font-size: 0.9rem; margin-bottom: 10px;">Customize your Runner!</p>
        <div id="skins-list" class="shop-items">
          <!-- Skins injected via JS -->
        </div>
      </div>

      <div id="store-content" class="tab-content active">
        <div class="shop-items">
          <button id="buy-magnet" class="item-btn">
            <div>Magnet</div>
            <div style="font-size: 0.8rem; opacity: 0.9;">Pulls all nearby Gold</div>
            <div class="price">30 G</div>
          </button>
          <button id="buy-potion" class="item-btn">
            <div>Iron Potion</div>
            <div style="font-size: 0.8rem; opacity: 0.9;">Smash through obstacles!</div>
            <div class="price">100 G</div>
          </button>
        </div>
      </div>

      <div id="mint-content" class="tab-content">
        <div class="shop-items">
          <button id="mint-horseshoe" class="item-btn" style="min-width: 200px;">
            <div style="font-size: 2.5rem;">ðŸ‘Ÿ</div>
            <div>Horse Shoe (NFT)</div>
            <div class="price">1000 G + 100 JADES</div>
          </button>
        </div>
        <p style="font-size: 1rem; opacity: 0.8;">NFT Verified Cosmetics â€¢ Unique Collection</p>
      </div>

      <button id="shop-back" style="margin-top: 20px;">Back</button>
    </div>
    <div id="paused-screen" class="screen">
      <h1>PAUSED</h1>
      <button id="music-toggle-pause" class="music-toggle">ðŸ”Š</button>
      <button id="resume-btn">Resume</button>
      <button id="shop-btn-pause" class="shop-btn">Shop</button>
      <button id="guide-btn-pause" class="guide-btn">Guide & Info</button>
      <button id="menu-btn-pause" style="margin-top: 10px;">Main Menu</button>
    </div>
    <div id="guide-screen" class="screen">
      <h1>GAME GUIDE</h1>
      <div class="guide-scrollable">
        <section>
          <h2 style="color: #4CAF50;">BASICS</h2>
          <p style="font-size: 1.1rem;">Swipe or Click the sides of the screen to move between lanes. Use the Jump
            button or Space/W to leap over obstacles and pits!</p>
        </section>
        <section>
          <h2 style="color: #FFD700;">OBSTACLES</h2>
          <p style="font-size: 1.1rem;">Avoid Hay Bales, Crate Boxes, and <strong>Double Boxes</strong>. Double Boxes
            are
            tallerâ€”you <strong>MUST JUMP</strong> to clear them! <strong>STONES</strong> are rare and
            have a high chance to drop <strong>JADES</strong> when smashed!</p>
        </section>
        <section>
          <h2 style="color: #00ffff;">POTIONS</h2>
          <p style="font-size: 1.1rem;"><strong>ðŸ§² MAGNET:</strong> Automatically loots all nearby gold for 30 seconds.
          </p>
          <p style="font-size: 1.1rem;"><strong>ðŸ§ª IRON BODY:</strong> Grants invincibility and allows you to smash
            through any obstacle for massive bonuses!</p>
        </section>
      </div>
      <button id="guide-close" style="margin-top: 20px;">CLOSE</button>
    </div>
    <div id="bag-screen" class="screen">
      <h1>YOUR BAG</h1>
      <div id="bag-items-list" class="shop-items">
        <!-- Items will be injected here -->
      </div>
      <button id="bag-close" style="margin-top: 20px;">Close</button>
    </div>
    <div id="hud" class="hidden">
      <div id="distance-hud">0000m</div>
      <!-- Touch Overlay for Movement -->
      <div id="touch-move-left" class="touch-zone"></div>
      <div id="touch-move-right" class="touch-zone"></div>



      <div id="quick-items-mobile">
        <button id="quick-magnet" class="quick-btn" style="display: none;">ðŸ§² <span class="count">0</span></button>
        <button id="quick-potion" class="quick-btn" style="display: none;">ðŸ§ª <span class="count">0</span></button>
      </div>

      <div id="gold-display">
        <div class="hud-item">
          <span class="coin-icon" style="width: 20px; height: 20px;"></span>
          <span id="run-gold-val">0</span>
        </div>
        <div class="hud-item wallet-hud">
          <span class="wallet-label">WALLET:</span>
          <span id="total-gold-hud">0</span>
        </div>
        <div class="hud-item wallet-hud">
          <span class="wallet-label">JADES:</span>
          <span id="total-jades-hud" style="color: #4CAF50;">0</span>
        </div>
        <div id="magnet-timer"
          style="display: none; font-size: 1.2rem; color: #00ffff; text-shadow: 1px 1px 0 #000; margin-top: 5px;">
          MAGNET: <span id="magnet-time-left">30</span>s
        </div>
        <div id="potion-hud"
          style="display: none; font-size: 1.2rem; color: #C0C0C0; text-shadow: 1px 1px 0 #000; margin-top: 5px;">
          IRON BODY: <span id="potion-charges">0</span>s
        </div>
      </div>

      <div id="notification"
        style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -150%); font-size: 3rem; color: #00ffff; pointer-events: none; opacity: 0; transition: opacity 0.3s, transform 0.5s; text-shadow: 3px 3px 0 #000; z-index: 1500; text-align: center; width: 100%;">
      </div>

      <button id="jump-btn-mobile" class="mobile-jump-btn" style="display: none;">JUMP</button>
      <button id="bag-btn" class="mobile-bag-btn">ðŸŽ’</button>
    </div>
  </div>
  <script type="module" src="/main.ts"></script>
</body>

</html>